const _0x321df9=_0x525e;(function(_0x54fa17,_0x216281){const _0x662c22=_0x525e,_0x4c6497=_0x54fa17();while(!![]){try{const _0x176a7d=parseInt(_0x662c22(0x108))/0x1+parseInt(_0x662c22(0xf8))/0x2+parseInt(_0x662c22(0xdf))/0x3*(-parseInt(_0x662c22(0xe5))/0x4)+parseInt(_0x662c22(0x11e))/0x5+parseInt(_0x662c22(0x115))/0x6*(parseInt(_0x662c22(0xe4))/0x7)+parseInt(_0x662c22(0xec))/0x8*(-parseInt(_0x662c22(0xe8))/0x9)+parseInt(_0x662c22(0x118))/0xa*(-parseInt(_0x662c22(0xee))/0xb);if(_0x176a7d===_0x216281)break;else _0x4c6497['push'](_0x4c6497['shift']());}catch(_0x2008c7){_0x4c6497['push'](_0x4c6497['shift']());}}}(_0x412b,0x6a8cf));function _0x525e(_0xf05395,_0x2accaa){const _0x412b3c=_0x412b();return _0x525e=function(_0x525ee3,_0x27f228){_0x525ee3=_0x525ee3-0xdb;let _0x1f5093=_0x412b3c[_0x525ee3];return _0x1f5093;},_0x525e(_0xf05395,_0x2accaa);}const SUPABASE_URL=_0x321df9(0xfc),SUPABASE_API_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJjY2Rvam9reGt6bGpraW12ZGFnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE2NjI5MTQsImV4cCI6MjA2NzIzODkxNH0.8PRQYgls09sKNNJZk9_HuwSCHjTUxDQM4RpRwkS5MQk',REST_HEADERS={'apikey':SUPABASE_API_KEY,'Authorization':_0x321df9(0x113)+SUPABASE_API_KEY,'Content-Type':_0x321df9(0xfe)};export async function checkSubscription(_0x432739){const _0xeb2de8=_0x321df9,_0x2bc353=SUPABASE_URL+_0xeb2de8(0x109)+encodeURIComponent(_0x432739),_0x2fbcb7=await fetch(_0x2bc353,{'headers':REST_HEADERS});if(!_0x2fbcb7['ok'])throw new Error(_0xeb2de8(0x10b));const [_0x33a002]=await _0x2fbcb7[_0xeb2de8(0x107)]();if(!_0x33a002){updateConnectionStatus(priceConnectionStatusElement,![],_0xeb2de8(0xf4));throw new Error(_0xeb2de8(0xf4));}const _0x29823b=new Date(),_0x1a5342=new Date(_0x33a002['start_date']),_0x57d7ea=new Date(_0x33a002['end_date']);return _0x33a002['is_subscribed']&&_0x1a5342<=_0x29823b&&_0x57d7ea>=_0x29823b;}function _0x412b(){const _0x3c5e42=['addEventListener','getItem','webSoucket\x20has\x20been\x20closed\x20---\x20onClose','CLOSED','Failed\x20to\x20restart\x20WebSocket\x20due\x20to\x20missing\x20tokens','Error\x20checking\x20gold\x20market\x20status:','json','201600ZocNpA','/devices?select=start_date,end_date,is_subscribed&mac_address=eq.','NO_SESSION','ŸÅÿ¥ŸÑ\x20ŸÅŸä\x20ÿ¨ŸÑÿ®\x20ÿ≠ÿßŸÑÿ©\x20ÿßŸÑÿ¨Ÿáÿßÿ≤','code','number','WebSocket\x20closed:','Gold\x20session\x20tokens\x20not\x20found.','snapshot','errorCode','üö´\x20ŸÑÿß\x20ŸäŸàÿ¨ÿØ\x20ÿßÿ™ÿµÿßŸÑ\x20ÿ•ŸÜÿ™ÿ±ŸÜÿ™\x20ÿ≠ÿßŸÑŸäÿßŸã.\x20ÿ≥Ÿäÿ™ŸÖ\x20ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±\x20ÿ≠ÿ™Ÿâ\x20ÿπŸàÿØÿ©\x20ÿßŸÑÿßÿ™ÿµÿßŸÑ.','Bearer\x20','stringify','500172zFmqCo','setItem','gold_token','20wcSlIQ','error','warn','online','onopen','send','1579935bSbxcU','bid','Session\x20expired,\x20tokens\x20removed\x20---\x20checkGoldMarketStatus','/configuration?id=eq.1&select=cst,token','SESSION_EXPIRED','quote','location','GET','destination','wasClean','669krgAUL','payload','gold_cst','status','ÿ™ŸàŸÉŸÜÿßÿ™\x20ÿ∫Ÿäÿ±\x20ÿµÿßŸÑÿ≠ÿ©','56VYnJMH','1772hXIkvm','/renew.html','ÿ≠ÿßŸÑÿ©\x20ÿßŸÑÿ≥ÿπÿ±:\x20ÿÆÿ∑ÿ£\x20ŸÅŸä\x20ÿßŸÑÿßÿ™ÿµÿßŸÑ','1026zIKqeT','parse','securityToken','ÿ≠ÿßŸÑÿ©\x20ÿßŸÑÿ≥ÿπÿ±:\x20ÿßŸÜŸÇÿ∑ÿπ\x20ÿßŸÑÿßÿ™ÿµÿßŸÑ','24296DNrJAw','GOLD','4234472Bgqwnq','data','marketData.subscribe','ERROR','WebSocket\x20error:','close','ÿßŸÑÿ¨Ÿáÿßÿ≤\x20ÿ∫Ÿäÿ±\x20ŸÖÿ≥ÿ¨ŸÑ','Session\x20expired,\x20tokens\x20removed\x20---\x20onMessage','cst','gold-price-subscription','933718phbida','ÿ≠ÿßŸÑÿ©\x20ÿßŸÑÿ≥ÿπÿ±:\x20ÿßŸÑÿ¨ŸÑÿ≥ÿ©\x20ŸÖŸÜÿ™ŸáŸäÿ©','https://api-capital.backend-capital.com/api/v1/markets/GOLD','OPEN','https://rccdojokxkzljkimvdag.supabase.co/rest/v1','onclose','application/json','onerror','error.invalid.session.token'];_0x412b=function(){return _0x3c5e42;};return _0x412b();}export async function fetchTokensFromSupabase(){const _0x4a52de=_0x321df9;try{const _0x47002c=await fetch(SUPABASE_URL+_0x4a52de(0x121),{'headers':REST_HEADERS});if(!_0x47002c['ok'])throw new Error('ŸÅÿ¥ŸÑ\x20ŸÅŸä\x20ÿ¨ŸÑÿ®\x20ÿßŸÑÿ™ŸàŸÉŸÜ');const _0x473f9a=await _0x47002c['json'](),{cst:_0x1e896e,token:_0x43ff2b}=_0x473f9a[0x0]||{};if(!_0x1e896e||!_0x43ff2b)throw new Error(_0x4a52de(0xe3));return localStorage[_0x4a52de(0x116)]('gold_cst',_0x1e896e),localStorage['setItem']('gold_token',_0x43ff2b),{'cst':_0x1e896e,'securityToken':_0x43ff2b};}catch(_0x5de03f){return console[_0x4a52de(0x119)](_0x5de03f),window[_0x4a52de(0xdb)]['href']=_0x4a52de(0xe6),null;}}export async function checkGoldMarketStatus(){const _0xa9d977=_0x321df9,_0x432377=localStorage[_0xa9d977(0x102)](_0xa9d977(0xe1)),_0x5dcc65=localStorage['getItem'](_0xa9d977(0x117));if(!_0x432377||!_0x5dcc65)return console[_0xa9d977(0x11a)](_0xa9d977(0x10f)),{'status':_0xa9d977(0x10a)};try{const _0x5cf6a0=await fetch(_0xa9d977(0xfa),{'method':_0xa9d977(0xdc),'headers':{'Content-Type':_0xa9d977(0xfe),'CST':_0x432377,'X-SECURITY-TOKEN':_0x5dcc65}}),_0x3cadb7=await _0x5cf6a0[_0xa9d977(0x107)]();if(_0x3cadb7[_0xa9d977(0x111)]==='error.invalid.session.token')return console[_0xa9d977(0x11a)](_0xa9d977(0x120)),{'status':_0xa9d977(0x122)};const _0x3f4138=_0x3cadb7?.[_0xa9d977(0x110)]?.['marketStatus'],_0x58e2e6=_0x3cadb7?.[_0xa9d977(0x110)]?.[_0xa9d977(0x11f)];return{'status':_0x3f4138==='TRADEABLE'?_0xa9d977(0xfb):_0xa9d977(0x104),'bid':_0x58e2e6};}catch(_0x575734){return console[_0xa9d977(0x119)](_0xa9d977(0x106),_0x575734),{'status':_0xa9d977(0xf1)};}}export function connectToGoldPriceWebSocket({onPriceUpdate:_0x2e949d,onStatusChange:_0x18a010,onSessionExpired:_0x14222d}){const _0x443a90=_0x321df9;let _0x2d9b1c=null;async function _0x56a04e(){const _0x112ad5=_0x525e,_0x1d41f2=await fetchTokensFromSupabase();_0x1d41f2?connectToGoldPriceWebSocket({'onPriceUpdate':_0x2e949d,'onStatusChange':_0x18a010,'onSessionExpired':_0x14222d}):(console[_0x112ad5(0x119)](_0x112ad5(0x105)),setTimeout(_0x56a04e,0xbb8));}function _0x19ba87(){const _0x45dcbf=_0x525e,_0x2569af=localStorage[_0x45dcbf(0x102)](_0x45dcbf(0xe1)),_0x5eae55=localStorage['getItem'](_0x45dcbf(0x117));return _0x2569af&&_0x5eae55?{'cst':_0x2569af,'securityToken':_0x5eae55}:null;}async function _0x26584c(){const _0x442296=_0x525e,_0x23d6f7=_0x19ba87();if(!_0x23d6f7)return _0x56a04e();if(_0x2d9b1c)_0x2d9b1c['close']();_0x2d9b1c=new WebSocket('wss://api-streaming-capital.backend-capital.com/connect'),_0x2d9b1c[_0x442296(0x11c)]=()=>{const _0x16e4e7=_0x442296;_0x18a010(!![],'ÿ≠ÿßŸÑÿ©\x20ÿßŸÑÿ≥ÿπÿ±:\x20ŸÖÿ™ÿµŸÑ\x20ÿ®ÿ£ÿ≥ÿπÿßÿ±\x20ÿßŸÑÿ∞Ÿáÿ®'),_0x2d9b1c[_0x16e4e7(0x11d)](JSON[_0x16e4e7(0x114)]({'destination':_0x16e4e7(0xf0),'correlationId':_0x16e4e7(0xf7),'cst':_0x23d6f7[_0x16e4e7(0xf6)],'securityToken':_0x23d6f7[_0x16e4e7(0xea)],'payload':{'epics':[_0x16e4e7(0xed)]}}));},_0x2d9b1c['onmessage']=_0x939834=>{const _0x55d8b0=_0x442296,_0x16814a=JSON[_0x55d8b0(0xe9)](_0x939834[_0x55d8b0(0xef)]);if(_0x16814a['errorCode']===_0x55d8b0(0x100)){console[_0x55d8b0(0x11a)](_0x55d8b0(0xf5)),_0x18a010(![],_0x55d8b0(0xf9)),_0x56a04e();return;}if(_0x16814a[_0x55d8b0(0xe2)]==='OK'&&_0x16814a[_0x55d8b0(0xdd)]===_0x55d8b0(0x123)&&_0x16814a[_0x55d8b0(0xe0)]){const _0xf848c2=_0x16814a[_0x55d8b0(0xe0)][_0x55d8b0(0x11f)];if(typeof _0xf848c2===_0x55d8b0(0x10d))_0x2e949d(_0xf848c2);}},_0x2d9b1c[_0x442296(0xfd)]=_0x7dcffd=>{const _0x209d71=_0x442296;_0x18a010(![],_0x209d71(0xeb)),console[_0x209d71(0x11a)](_0x209d71(0x103)),console[_0x209d71(0x11a)](_0x209d71(0x10e),{'code':_0x7dcffd[_0x209d71(0x10c)],'reason':_0x7dcffd['reason'],'wasClean':_0x7dcffd[_0x209d71(0xde)]});if(!navigator['onLine']){console[_0x209d71(0x11a)](_0x209d71(0x112));return;}setTimeout(_0x56a04e,0xbb8);},_0x2d9b1c[_0x442296(0xff)]=_0x206c80=>{const _0x46bcd4=_0x442296;console[_0x46bcd4(0x119)](_0x46bcd4(0xf2),_0x206c80),_0x18a010(![],_0x46bcd4(0xe7)),_0x56a04e();};}return _0x26584c(),{'close':()=>_0x2d9b1c?.[_0x443a90(0xf3)]()};}window[_0x321df9(0x101)](_0x321df9(0x11b),()=>{console['log']('üí°\x20ÿ™ŸÖ\x20ÿßÿ≥ÿ™ÿπÿßÿØÿ©\x20ÿßŸÑÿßÿ™ÿµÿßŸÑ\x20ÿ®ÿßŸÑÿ•ŸÜÿ™ÿ±ŸÜÿ™ÿå\x20ÿ≥Ÿäÿ™ŸÖ\x20ÿ•ÿπÿßÿØÿ©\x20ÿßŸÑÿßÿ™ÿµÿßŸÑ\x20ÿ®ÿßŸÑÿ≥Ÿäÿ±ŸÅÿ±...'),restartConnection();});
